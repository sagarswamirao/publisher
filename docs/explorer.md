# Malloy Explorer: Visual Query Builder for Malloy

## 1. Introduction

**Malloy Explorer** is a no-code, visual query builder built on top of the [Malloy](https://malloydata.dev) semantic modeling language. It provides a seamless interface for exploring data, analyzing key business metrics, and building reusable queries — all without writing code. Under the hood, every action in the Explorer generates valid Malloy, ensuring semantic consistency & trust while enabling flexible data exploration.

Designed for data consumers and developers alike, Malloy Explorer brings the power of governed semantic models to a modern, interactive user experience. It empowers users to ask complex questions, segment and visualize results, and drill into the details with nested structures — all from a single interface.

### Key Benefits

- **Semantic-first foundation** – Every query runs against a Malloy model, which captures the business meaning and relationships of the data.
- **No-code UX** – Construct queries visually using dimensions, measures, filters, and charts.
- **Live, nested analysis** – Easily drill down into rich multi-level breakdowns using Malloy's native nesting capabilities.
- **Full transparency** – View the Malloy and SQL generated by your visual query.
- **AI and developer ready** – All queries are valid Malloy code, making them composable, reusable, and LLM-consumable.
- **Guaranteed correct metrics** - Malloy supports **symmetric aggregates**, ensuring that metrics compute correctly even across joins with varying cardinality. This eliminates common errors found in traditional SQL-based tools. ([Learn more](https://cloud.google.com/looker/docs/best-practices/understanding-symmetric-aggregates))

### Interface Overview

Malloy Explorer is organized into three main panels:

1. **Source Panel** – Browse available dimensions, measures, and views from the semantic model.
2. **Query Panel** – Assemble and refine your query using a clean visual editor.
3. **Results Panel** – View results as tables or charts, and inspect the underlying Malloy and SQL.

<img src="explorer-screenshots/explorer-full-UI.png" alt="Explorer Full UI" width="900" style="max-width: 100%; height: auto;">

---

## 2. Source Panel

The **Source Panel** is where exploration begins. It presents the structure of the selected Malloy model — typically organized around a central transactional or fact table — and surfaces all the fields and reusable logic available for analysis.

The panel is organized into three sections:

- **Dimensions** – Attributes you can group by, filter on, or sort with.
- **Measures** – Predefined metrics you can aggregate, filter on, or sort with.
- **Views** – Saved queries or perspectives authored in the model and ready to run.

<img src="explorer-screenshots/source-panel.png" alt="Source Panel" width="250" style="max-width: 100%; height: auto;">

Hovering over a field or view in the Source Panel will show actions you can take to add it to your query - selections will immediately appear in the **Query Panel**, ready to run or modify.

### Dimensions

The **Dimensions** section lists descriptive fields — such as IDs, dates, categories, and derived attributes — from both the primary model and any joined sources.

Dimensions are grouped by their source. For example, in a query centered around `order_items`, you might also see dimensions from joined models like `users`, `inventory_items`, or `products`.

Hovering over a dimension reveals contextual actions:

- **Add as Group By** – Segment the result by this dimension.
- **Add as Filter** – Apply a filter based on the field.
- **Add as Sort** – Sort the result set by this value.

<img src="explorer-screenshots/source-panel-dimension-hover-groupby.png" alt="Source Panel Dimension Hover Actions" width="250" style="max-width: 100%; height: auto;">

### Measures

The **Measures** section contains all aggregated metrics available in the current model. These are grouped by source and include calculations such as totals, averages, counts, and ratios.

Hovering over a measure provides the following actions:

- **Add as Aggregate** – Include the metric in the result set.
- **Add as Filter** – Use the measure to restrict the result set.
- **Add as Sort** – Sort results based on the metric value.

<img src="explorer-screenshots/source-panel-measure-hover-aggregate.png" alt="Source Panel Measures Hover Actions" width="250" style="max-width: 100%; height: auto;">

### Views

The **Views** section surfaces saved queries defined in the underlying Malloy model. These views often represent curated KPIs, commonly-used explorations, or analytical building blocks. Views can be a good starting point for your queries, or may be useful to nest within your query to dive deeper.

Hovering over a view provides the following actions:

- **Add to Query** – Add the view to your query.
- **Add as Nested Query** – Add the view to your query as a nested query.

<img src="explorer-screenshots/source-panel-view-hover-add-to-query.png" alt="Source Panel View Hover Actions" width="260" style="max-width: 100%; height: auto;">

Clicking a view loads its full query into the **Query Panel**, where it can be run, modified, or used as a base for deeper exploration. If a query is already open, the view will be added to the query as a nested query.

---

## 3. Query Panel

The **Query Panel** is where queries come together. It provides a structured, visual representation of your query — and supports far more than basic field selection.

### Top Components

- **Run Button** – Executes the query and displays the result.
- **Clear Button** – Removes the current query configuration.
- **Source** – Displays the source the query is running against.
- **Main query**

  - **Add Query Element** (`+`)
  - **More Actions Menu (`...`)** – Includes:
    - **Clear Query**
    - **Nest Query** (used to add subqueries — see below)
  - **Chart Type Selector** – Select the type of chart to display the results.
  - **Query display** – Displays the current query you've built.

<img src="explorer-screenshots/query-panel-with-query.png" alt="Query Panel Example" width="350" style="max-width: 100%; height: auto;">

### Add Query Element (`+`)

This menu allows you to add fields and logic by _operation_, rather than by data source. Categories include:

- **Add Group By**
- **Add Aggregate**
- **Add Filter**
- **Add View**
- **Limit**
- **Order By**
- **Add Blank Nested Query**

<img src="explorer-screenshots/query-panel-add-action.png" alt="Add Query Element" width="675" style="max-width: 100%; height: auto;">

### Display Format Selector

Choose how to visualize your results. Available formats include:

- Table
- Bar Chart
- Dashboard
- Line Chart
- JSON
- List / List Detail
- Dashboard
- Point Map
- Scatter Chart
- Segment Map

<img src="explorer-screenshots/query-panel-chart-selector.png" alt="Query Panel Format Selector" width="350" style="max-width: 100%; height: auto;">

### Query Configuration

Your current query is displayed using clearly labeled sections:

- **Group By**
- **Aggregate**
- **Filter By**
- **Order By**
- **Limit**

Each section reflects the logic of your query and is fully editable.

Hovering over a section will show another way to add elements to the query.

<img src="explorer-screenshots/query-panel-hover-groupby.png" alt="Query Panel Hover Actions" width="350" style="max-width: 100%; height: auto;">

---

### Nested Queries

Malloy's **nesting** feature enables rich, multidimensional analysis — and the Explorer gives you a no-code way to use it.

To add a nested query, either:

- Select **Nest Query** from the Query Panel **More Actions** menu.
- Hover over a view in the Source Panel and select **Add as Nested Query**.

<img src="explorer-screenshots/query-panel-more-nest.png" alt="Query Panel Nest Action" width="350" style="max-width: 100%; height: auto;">

Each nested block can have its own groupings, aggregates, filters, ordering and even additional nests.

<img src="explorer-screenshots/query-panel-build-nested-query.png" alt="Building a Nested Query" width="625" style="max-width: 100%; height: auto;">

Use nesting to:

- Break down results by subgroups
- Create expandable subtables or charts
- Explore deep, layered data relationships

> Malloy compiles nested blocks into safe, aggregating subqueries in SQL. Filters can be scoped to any level.

Reference: [Malloy Nested Views Documentation](https://malloydata.dev/docs/nested-views)

---

## 4. Results Panel

The **Results Panel** displays your query output whenever you click **Run**. Results are rendered according to your selected chart type and include support for nested results.

### Visual Output

The Results Panel renders results in the format specified by in the query above (e.g., table, chart, dashboard, etc.).

<img src="explorer-screenshots/results-panel.png" alt="Example Results Panel" width="800" style="max-width: 100%; height: auto;">

Nested queries produce expandable sub-tables or inline charts that show multidimensional breakdowns per row.

### Code Transparency

Alongside visual output, the Results Panel includes:
**Malloy Tab** – Shows the Malloy query generated by your visual configuration.

<img src="explorer-screenshots/results-malloy.png" alt="Generated Malloy View" width="450" style="max-width: 100%; height: auto;">

**SQL Tab** – Displays the fully compiled SQL sent to the database.

<img src="explorer-screenshots/results-sql.png" alt="Generated SQL View" width="600" style="max-width: 100%; height: auto;">

This transparency gives developers, analysts, and AI systems full access to inspect, reproduce, or extend any query.

---

## Summary

Malloy Explorer combines semantic modeling with a powerful, no-code visual interface for data exploration. It enables you to:

- Build and run queries visually, without writing code
- Use governed metrics and reusable models for consistency
- Analyze data across multiple dimensions with nested queries
- Instantly view results as tables or charts, including expandable sub-tables
- Inspect generated Malloy and SQL code for transparency and reproducibility
- Rely on symmetric aggregates for accurate, consistent results as you drill in and out

With Malloy Explorer, everyone can ask better questions — and trust the answers.
